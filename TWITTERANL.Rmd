---
title: "R Notebook"
output:
  word_document: default
  html_notebook: default
editor_options:
  chunk_output_type: console
---



```{r echo=FALSE, message=TRUE, warning=TRUE, paged.print=TRUE}
library(twitteR)
library(ROAuth)
library(tm)
library(RCurl)
library(RColorBrewer) 
library(plyr)
library(stringr)
library(base64enc)
library(SnowballC)
library(ggplot2)
library(maps)
options(RCurlOptions = list(cainfo = system.file("CurlSSL", "cacerrt.pem", package = "RCurl" )))

#TWITTER'S CODES
api_key <- "vIkAizWi4IVHeMdrIBh9M1Te2"
api_secret <- "KOi61eakFFxhEBhgfub8LMoVBBBudHVi0eqp64DPhsVrwR9EIJ"
access_token <- "366791789-YUtGBca52t0fU0KtR73q7dYLDGI6lmfit7vM2GHP"
access_token_secret <- "tZPNpWJdYjPqwkWRtL9YRHbO746RQIH81SbWcBjeGuTGw"

#TWEET CRED
setup_twitter_oauth(api_key, api_secret, access_token, access_token_secret)



#HASHTAG'DEN VERİ ÇEKMEK
library(tidyverse)
availableTrendLocations() %>% filter(country == "Turkey")
h <- getTrends(2343732)
head(h, 20)
tw <- searchTwitter("#herşeyçokgüzelolacak", n = 200)

class(tw)
str(tw)

df_tw <- twListToDF(tw)
View

#########


#Appending some more words to actual words
pos.words2 = c('güzel','makam', 'iyi','olumlu','başarı')
neg.words2 = c( 'asla', 'olmaz','kötü', 'olumsuz')

df$text
#converting Into dataFrame
#calcuating result
result <- score.sentiment(df$text,pos.words2,neg.words2)
result
#summarlizing data
summary(result$score)

#Histogram
hist(result$score,col="yellow", main="Score of tweets",ylab=" Count of tweets")

#Count No of Tweets
count(result$score)

#ploting the tweets on qplot
qplot(result$score,xlab = "Score of tweets")

#score Sentiment function
#Used to remove all unwanted data 
score.sentiment = function(sentences, pos.words, neg.words, .progress='none')
{
    require(plyr)
    require(stringr)
    scores = laply(sentences, function(sentence, pos.words, neg.words) {
    sentence = gsub('[[:punct:]]', '', sentence)
    sentence = gsub('[[:cntrl:]]', '', sentence)
    sentence = gsub('\\d+', '', sentence)
    sentence = tolower(sentence)
    word.list = str_split(sentence, '\\s+')
    words = unlist(word.list)
    pos.matches = match(words, pos.words)
    neg.matches = match(words, neg.words)
    pos.matches = !is.na(pos.matches)
    neg.matches = !is.na(neg.matches)
    score <- sum(pos.matches) - sum(neg.matches)
    return(score)
    }, pos.words, neg.words, .progress=.progress )
    
    scores.df = data.frame(score=scores, text=sentences)
    return(scores.df)
}

    
plot(cars)
```



